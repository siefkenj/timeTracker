// Generated by CoffeeScript 1.9.0
var app, setupMonth,
  __modulo = function(a, b) { return (+a % (b = +b) + b) % b; };

setupMonth = function(displayMonth) {
  var day, displayDays, firstDay, index, lastMonth, month, nextMonth, numDays, remainingDays, result, thisMonth, week, x, year, _i, _len;
  year = displayMonth.getFullYear();
  month = displayMonth.getMonth();
  firstDay = displayMonth.getDay();
  lastMonth = ((function() {
    var _i, _results;
    _results = [];
    for (x = _i = 0; 0 <= firstDay ? _i < firstDay : _i > firstDay; x = 0 <= firstDay ? ++_i : --_i) {
      _results.push((new Date(year, month, -x)).getDate());
    }
    return _results;
  })()).reverse();
  numDays = (new Date(year, month + 1, 0)).getDate();
  thisMonth = (function() {
    var _i, _results;
    _results = [];
    for (x = _i = 1; 1 <= numDays ? _i <= numDays : _i >= numDays; x = 1 <= numDays ? ++_i : --_i) {
      _results.push(x);
    }
    return _results;
  })();
  remainingDays = __modulo(7 - __modulo(numDays + firstDay, 7), 7);
  nextMonth = (function() {
    var _i, _results;
    _results = [];
    for (x = _i = 0; 0 <= remainingDays ? _i < remainingDays : _i > remainingDays; x = 0 <= remainingDays ? ++_i : --_i) {
      _results.push(x + 1);
    }
    return _results;
  })();
  displayDays = lastMonth.concat(thisMonth.concat(nextMonth));
  result = [];
  week = [];
  for (index = _i = 0, _len = displayDays.length; _i < _len; index = ++_i) {
    day = displayDays[index];
    week.push(day);
    console.log(index, day, (index + 1) % 7);
    if (!((index + 1) % 7)) {
      result.push(week);
      week = [];
    }
  }
  return result;
};

app = angular.module('App', []);

app.controller('Calendar', [
  '$scope', function($scope) {
    var locale, month, now, year;
    locale = 'en-us';
    now = new Date();
    year = now.getFullYear();
    month = now.getMonth();
    $scope.monthNum = month;
    $scope.yearNum = year;
    $scope.month = function() {
      var date;
      date = new Date($scope.yearNum, $scope.monthNum, 1);
      return date.toLocaleDateString(locale, {
        month: 'long'
      });
    };
    $scope.$watch('monthNum', function() {
      return $scope.displayDays = setupMonth(new Date($scope.yearNum, $scope.monthNum, 1));
    });
  }
]);
